name: lbrlabs-eks-yaml
runtime: yaml
description: A minimal Pulumi YAML program
resources:
  vpc:
    type: awsx:ec2:Vpc
    properties:
      cidrBlock: "172.16.0.0/16"
      subnetSpecs:
        - type: public
          tags:
            "kubernetes.io/role/elb": "1"
        - type: private
          tags:
            "kubernetes.io/role/internal-elb": "1"
  cluster:
    type: lbrlabs-eks:index:Cluster
    properties:
      vpcId: ${vpc.vpcId}
      clusterSubnetIds: ${vpc.publicSubnetIds}
      systemNodeSubnetIds: ${vpc.privateSubnetIds}
      systemNodeInstanceTypes: [ "t3.large" ]
      systemNodeDesiredCount: 4
  workloadNodes:
    type: lbrlabs-eks:index:AttachedNodeGroup
    properties:
      clusterName: ${cluster.controlPlane.name}
      subnetIds: ${vpc.privateSubnetIds}
outputs:
  kubeconfig: ${cluster.kubeconfig}
